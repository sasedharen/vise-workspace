# VISE Project - Current Development Context

## Active Development
**Module:** admissions
**Feature:** Schema migration from admissions to users schema
**User Story:** As a developer, I want to ensure proper data migration and integrity between schemas

## Authentication Context
**Testing Role:** BRANCH_ADMIN
**Branch ID:** branch_001
**Permissions:** ["create:admission", "read:admission", "update:admission"]

## Recent Changes
- [x] Fixed admissions seeder uniqueness constraints for Aadhaar ID, APAAR ID, and mobile numbers
- [x] Added application ID length validation to satisfy database check constraint (24 characters)
- [x] Added cascade delete to foreign key constraints in users schema via Flyway migration
- [x] Fixed draft save functionality in application service
- [x] Implemented proper data clearing in seeder respecting foreign key constraints

## Database Schema Status
| Table | Migration | GORM Model | TypeScript Interface |
|-------|-----------|------------|---------------------|
| users.application | ✅ V24 | ✅ Updated | ✅ Synchronized |
| users.student | ✅ V23 | ✅ Updated | ✅ Synchronized |
| users.document | ✅ V18 | ✅ Updated | ✅ Synchronized |
| users.student_academic_data | ✅ V18 | ✅ Updated | ✅ Synchronized |

## Current File Locations
- Seeder: `vise-backend/internal/admissions/seeder/application.go`
- Migration: `vise-backend/db/migrations/V24__add_cascade_delete_to_application_fks.sql`
- Student Model: `vise-backend/internal/users/domain/student.go`
- Application Model: `vise-backend/internal/users/domain/application.go`
- Draft Save Service: `vise-backend/internal/admissions/service/application_savedraft.go`

## Integration Points
- Admissions seeder generates data for both college and school applications
- Application draft save functionality creates unique IDs and starts temporal workflow
- CASCADE DELETE on application foreign keys allows for proper data cleanup
- Database schema enforces uniqueness constraints on student identifiers
1. Frontend calls → vise-backend/api/v1/admission
2. Backend validates token → auth-service/api/auth/verify
3. Backend checks permissions → auth-service/api/auth/check-permission
4. Backend returns data → Frontend displays

## Known Issues
- [ ] Token refresh not working in vise-frontend
- [ ] Branch isolation not enforced in admission list
- [ ] Missing rate limiting on admission creation

## Test Accounts
```json
{
  "admin": {
    "email": "admin@vise.edu",
    "role": "BRANCH_ADMIN",
    "branch_id": "branch_001"
  },
  "teacher": {
    "email": "teacher@vise.edu",
    "role": "TEACHER",
    "branch_id": "branch_001"
  }
}